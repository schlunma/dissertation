%=============================================================================%
%                                Dissertation                                 %
%                               Manuel Schlund                                %
%                                  (c) 2020                                   %
%=============================================================================%
%                                  Paper GPP                                  %
%=============================================================================%



\chapter{Constraining Future Gross Primary Production with Machine Learning}
\label{ch:06:paper_gpp}

As argued in detail in the previous chapter, single-process-oriented emergent
constraints do not seem to be beneficial in constraining climate projections
from the vastly complex modern-day \acp{ESM} since they might overly simplify
the problem. To overcome this issue, we explore an alternative approach that
expands the \acf{MDER} method with a supervised \acf{ML} algorithm. In contrast
to emergent constraints, this approach considers (1) multiple process-based
predictors, (2) multi-dimensional (gridded) target variables and (3) non-linear
relationships between the predictors and the target variable. Since the new
technique relies on a large number of data points in order to train the \ac{ML}
algorithm, \ac{ECS} as a single scalar metric for each climate model is not an
appropriate target variable. As an alternative, we analyze projections of
future \acf{GPP} in this study, which constitutes the largest flux of the
terrestrial carbon uptake. As described in detail in
\cref{subsec:02:carbon_cycle_perturbations}, the global carbon cycle actively
slows down global warming by removing \ac{CO2} from the atmosphere. In
particular, the terrestrial biosphere absorbs about $30 \unit{\%}$ of the total
anthropogenic \ac{CO2} emission \autocite{Friedlingstein2020}. Thus, accurately
quantifying the future evolution of the terrestrial carbon sink is crucial for
reliable climate change projections.

Due to complex feedback processes connected to the global carbon cycle
(concentration-carbon feedback and climate-carbon feedback; see
\cref{subsec:02:carbon_cycle_perturbations}), the response of the terrestrial
carbon cycle to changes in the atmospheric \ac{CO2} concentration and climate
is a major source of uncertainty in climate projections \autocite{Bodman2013,
  Booth2012, Collins2013}. This applies for example to multi-model projections
of future \ac{GPP} of the \acs{CMIP}5 ensemble. Thus, the aim of this study is
to reduce uncertainties in multi-model projections of future \ac{GPP} in the
\acs{CMIP}5 \acs{RCP}8.5 scenario at the end of the \nth{21} century with a new
\ac{ML}-based weighting technique and appropriate observations. The new
two-step approach utilizes aspects of emergent constraints and the \ac{MDER}
technique in combination with a \ac{ML} algorithm. In the first step, we apply
an existing emergent constraint on \ac{CO2} fertilization \autocite{Wenzel2016}
to constrain the \acp{ESM}' responses to rising atmospheric \ac{CO2}
concentration using observations of the increase of the \ac{CO2} seasonal cycle
amplitude at Cape Kumukahi, Hawaii \autocite{Keeling2005}. In a second step, we
introduce a supervised \ac{ML} algorithm based on boosting trees
\autocite{Friedman2001} to learn an empirical spatial relationship that links
grid-wise future \ac{GPP} to historical processes relevant to its simulation
under present-day conditions. In combination with observational products of the
predictors, that relationship can be used to further constrain uncertainties in
the projected spatial maps of \ac{GPP} at the end of the \nth{21} century in
the \acs{RCP}8.5 scenario. We examine both constraining the absolute \ac{GPP}
and the fractional change in \ac{GPP} as two independent approaches and target
variables. Unlike univariate linear regression used in the \ac{MDER} algorithm,
the proposed \ac{GBRT} algorithm is able to handle multiple predictors and
copes with non-linearities in the data. \ac{GBRT} is a well-known and
successful tool used for interpolation, classification and prediction in other
fields of data science and engineering \autocite{Death2007, Elith2008}. In the
context of climate science, \ac{GBRT} was recently applied to identify the key
drivers of spatial variations of the ratio of plant transpiration to total
terrestrial evapotranspiration in \acp{ESM} \autocite{Lian2018}.

This work is already published in \textcite{Schlund2020}. For this paper, the
author of this thesis lead the writing and the analysis and implemented the
code to reproduce this study with all figures and tables using the
\ac{ESMValTool}. \Cref{sec:06:data_and_methods} of this chapter provides an
overview of the data and methods used in this paper. The results are presented
in \cref{sec:06:results} and \cref{sec:06:summary_and_discussion} closes with a
summary and discussion.


\section{Data and Methods}
\label{sec:06:data_and_methods}

TBA.

\begin{figure}[t]
  \centering
  \includegraphics[width=\LargeFigureWidth{}]{
    ch06_paper_gpp/figs/schematic_steps.pdf}
  \caption{Schematic illustration of our two-step approach. In step 1 an
    emergent constraint by \textcite{Wenzel2016} is used to constrain the
    global mean fractional change in \acf{GPP} over the 21st century.
    Moreover, this constraint is used to rescale two different gridded target
    variables: absolute \acs{GPP} at the end of the \nth{21} century and
    fractional \acs{GPP} change over the \nth{21} century. In step 2, a
    \acl{ML} model is used to constrain these two target variables (step 2a:
    absolute \acs{GPP}; step 2b: fractional \acs{GPP} change) in two
    independent approaches. \AdaptedFrom{Schlund2020}.}
  \label{fig:06:schematic_steps}
\end{figure}

\begin{figure}[p]
  \centering
  \includegraphics[width=\LargerFigureWidth{}]{
    ch06_paper_gpp/figs/mlr_concept.pdf}
  \caption{Schematic illustration of our \acf{ML} approach to constrain
    projected absolute \acf{GPP} in step 2a. (a) In the training phase of the
    algorithm, the model is fitted to the training data interpolating the
    empirical (non-linear) relationship between two process-oriented
    diagnostics of the past climate $\left\{ x^{(1)}, x^{(2)} \right\}$ and
    (rescaled) future \acs{GPP} (gray surface). The points show the training
    points for the supervised \acs{ML} algorithm, each of them representing a
    single grid cell/month of a single climate model (the different colors
    correspond to different climate models). (b) In the prediction phase,
    observation-based values of the diagnostic (black points) are fed into the
    trained \acs{ML} model to constrain \acs{GPP} for every grid cell/month to
    a value which best agrees with the observations. (c) For an independent
    validation of our method, we use an out-of-sample testing setup based on a
    leave-one-model-out \acl{CV} approach (see
    \cref{subsec:02:model_weighting} for details). The schematic illustration
    of step 2b differs only in the target variable used (fractional \acs{GPP}
    change instead of absolute \acs{GPP}). \AdaptedFrom{Schlund2020}.}
  \label{fig:06:mlr_concept}
\end{figure}


\subsection{Constraining the \texorpdfstring{\acs{CO2}}{CO2} Fertilization
  Effect (Step 1)}
\label{subsec:06:step_1}

TBA.


\section{Results}
\label{sec:06:results}

TBA.

\begin{figure}[t]
  \centering
  \begin{subfigure}[b]{\SubfigureWidth{}}
    \raisebox{5.5mm}{\includegraphics[width=\columnwidth]{
      ch06_paper_gpp/figs/step2a_rmse.pdf}}
    \caption{}
    \label{fig:06:step2a_ml_inference:a}
  \end{subfigure}
  ~
  \begin{subfigure}[b]{\SubfigureWidth{}}
    \includegraphics[width=\columnwidth]{
      ch06_paper_gpp/figs/step2a_global_feature_importance.pdf}
    \caption{}
    \label{fig:06:step2a_ml_inference:b}
  \end{subfigure}
  \caption{(a) Box plot of the \acf{RMSEP} distributions for six different
    statistical models used to predict future absolute \acf{GPP} in step 2a
    using a leave-one-model-out \acl{CV} approach. The distribution for each
    statistical model contains seven elements (black points; one for each
    climate model used as truth) and is represented in the following way: The
    lower and upper limit of the blue boxes correspond to the $25 \unit{\%}$
    and $75 \unit{\%}$ quantiles, respectively. The central line in the box
    shows the median and the black \enquote{x} shows the mean of the
    distribution. The whiskers outside the box represent the range of the
    distribution. Compared to the \acs{CMIP}5 \acf{MMM} and its corresponding
    rescaled version (r\acs{MMM}), the prediction uncertainty measured by the
    mean \acs{RMSEP} is significantly reduced by up to $48 \unit{\%}$ and $39
    \unit{\%}$, respectively, when using other statistical models. Moreover,
    the non-linear \acf{GBRT} models can slightly reduce the mean \acs{RMSEP}
    compared to the linear \acf{LASSO} models by about $2 \unit{\%}$ for
    \acs{GBRT}-1D (using historical \acs{GPP} as single predictor) and $3
    \unit{\%}$ for the full \acs{GBRT} model (using all predictors). (b)
    Relative global feature importance for the different predictors used in
    the \acs{GBRT} model to predict future absolute \acs{GPP} (step 2a). The
    red bars correspond to positive Pearson correlation coefficients between
    all predictors and the target variable. Due to its strong positive linear
    relationship with the future \acs{GPP}, the historical \acs{GPP} is by far
    the most important predictor in the model. A local feature importance map
    using \acf{LIME} is not shown here because \acs{GPP} is the dominant
    predictor for all grid cells. \AdaptedFrom{Schlund2020}.}
  \label{fig:06:step2a_ml_inference}
\end{figure}


\section{Summary and Discussion}
\label{sec:06:summary_and_discussion}

TBA.
